\documentclass[../main.tex]{subfiles}

\begin{document}

\index{Players ! Marshall, Frank James $\square$}
\index{Players ! Capablanca, Jose Raul $\blacksquare$}
\subsection{Marshall, Frank James vs. Capablanca, Jose Raul -- 1/2-1/2 -- C49}
\begin{multicols*}{2}

% Game's Opening ECO data
\index{Openings ! C25 -- Vienna: 2...Nc6}
\subsubsection{C25 -- Vienna: 2...Nc6}
\begin{flushleft}
\newchessgame[id=eco]
\longmoves
\mainline{1. e4 e5 2. Nc3 Nc6}
\begin{center}
\begin{tabular}{C{60mm}}
\chessboard[setfen={r1bqkbnr/pppp1ppp/2n5/4p3/4P3/2N5/PPPP1PPP/R1BQKBNR w KQkq - 2 3},
             pgfstyle=border,
             color=YellowGreen,
             markfields={b8,c6},
             pgfstyle=straightmove,
             color=YellowGreen,
             markmoves={b8-c6}]
\newline
\xskakset{moveid=\xskakgetgame{lastmoveid}}
\printmovercolor{\xskakgetgame{lastplayer}}
\end{tabular}
\end{center}
% PGN tags
\begin{tabular}{L{60mm} R{10mm}}
\multicolumn{2}{l}{\textbf{New York, USA m}}\\ 
\multicolumn{2}{l}{1909 Round 17}\\[3mm]
\textbf{$\square$ \hspace{2mm} Marshall, Frank James} & \textbf{1/2}\\ 
\textbf{$\blacksquare$ \hspace{2mm} Capablanca, Jose Raul} & \textbf{1/2}\\ 
\end{tabular}

% Game's final diagram and result
\newchessgame[id=overview]
\longmoves
\hidemoves{1. e4 e5 2. Nc3 Nc6}\mainline{3. Nf3 Nf6 4. Bb5 Bb4 5. O-O O-O 6. d3 d6 7. Bg5 Bxc3 8. bxc3 Ne7 9. Nh4 c6 10. Ba4 Ne8 11. Bb3 Be6 12. Bxe6 fxe6 13. Qg4 Qd7 14. f4 exf4 15. Rxf4 Rxf4 16. Qxf4 Nf6 17. Bxf6 Rf8 18. Qe3 Rxf6 19. Qxa7 g5 20. Nf3 g4 21. Qd4 Rf7 22. Ne5 c5 23. Nxd7 cxd4 24. Rf1 Rxf1+ 25. Kxf1 dxc3 26. Nf6+ Kf7 27. Nxg4 Nc6 28. Ne3 b5 29. a3 b4 30. axb4 Nxb4 31. Ke2 d5 32. exd5 exd5 33. d4 Kf6 34. g3 h5 35. h3 Kg5 36. h4+ Kf6 37. Kf3 Ke6 38. g4 hxg4+ 39. Kxg4 Nc6 40. Nf5 Nb4 41. h5 Kf7 42. Ne3 Nc6 43. h6 Kg6 44. Nxd5 Nxd4 45. Ne3 Nxc2}

\begin{center}
\begin{tabular}{C{60mm}}
\xskakset{moveid=\xskakgetgame{lastmoveid}}
\chessboard[setfen=\xskakget{nextfen},
       pgfstyle=border,
       color=YellowGreen,
       markfields={d4,c2},
             pgfstyle=straightmove,
             color=YellowGreen,
             markmoves={d4-c2}]
\newline
45. ...\,\xskakget{lan}
\newline
1/2-1/2
\end{tabular}
\end{center}
\end{flushleft}
\end{multicols*}
\newpage
\end{document}
