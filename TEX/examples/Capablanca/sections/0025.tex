\documentclass[../main.tex]{subfiles}

\begin{document}

\index{Players ! Marshall, Frank James $\square$}
\index{Players ! Capablanca, Jose Raul $\blacksquare$}
\subsection{Marshall, Frank James vs. Capablanca, Jose Raul -- 0-1 -- D53}
\begin{multicols*}{2}

% Game's Opening ECO data
\index{Openings ! D53 -- QGD: Early Lasker Variation}
\subsubsection{D53 -- QGD: Early Lasker Variation}
\begin{flushleft}
\newchessgame[id=eco]
\longmoves
\mainline{1. d4 d5 2. c4 e6 3. Nc3 Nf6 4. Bg5 Be7 5. e3 Ne4}
\begin{center}
\begin{tabular}{C{60mm}}
\chessboard[setfen={rnbqk2r/ppp1bppp/4p3/3p2B1/2PPn3/2N1P3/PP3PPP/R2QKBNR w KQkq - 1 6},
             pgfstyle=border,
             color=YellowGreen,
             markfields={f6,e4},
             pgfstyle=straightmove,
             color=YellowGreen,
             markmoves={f6-e4}]
\newline
\xskakset{moveid=\xskakgetgame{lastmoveid}}
\printmovercolor{\xskakgetgame{lastplayer}}
\end{tabular}
\end{center}
% PGN tags
\begin{tabular}{L{60mm} R{10mm}}
\multicolumn{2}{l}{\textbf{New York, USA m}}\\ 
\multicolumn{2}{l}{1909 Round 11}\\[3mm]
\textbf{$\square$ \hspace{2mm} Marshall, Frank James} & \textbf{0}\\ 
\textbf{$\blacksquare$ \hspace{2mm} Capablanca, Jose Raul} & \textbf{1}\\ 
\end{tabular}

% Game's final diagram and result
\newchessgame[id=overview]
\longmoves
\hidemoves{1. d4 d5 2. c4 e6 3. Nc3 Nf6 4. Bg5 Be7 5. e3 Ne4}\mainline{6. Bxe7 Qxe7 7. Bd3 Nxc3 8. bxc3 dxc4 9. Bxc4 b6 10. Qf3 c6 11. Ne2 Bb7 12. O-O O-O 13. a4 c5 14. Qg3 Nc6 15. Nf4 Rac8 16. Ba2 Rfd8 17. Rfe1 Na5 18. Rad1 Bc6 19. Qg4 c4 20. d5 Bxa4 21. Rd2 e5 22. Nh5 g6 23. d6 Qe6 24. Qg5 Kh8 25. Nf6 Rxd6 26. Rxd6 Qxd6 27. Bb1 Nc6 28. Bf5 Rd8 29. h4 Ne7 30. Ne4 Qc7 31. Qf6+ Kg8 32. Be6 fxe6 33. Qxe6+ Kf8 34. Ng5 Ng8 35. f4 Re8 36. fxe5 Re7 37. Rf1+ Kg7 38. h5 Be8 39. h6+ Kh8 40. Qd6 Qc5 41. Qd4 Rxe5 42. Qd7 Re7 43. Rf7 Bxd7}

\begin{center}
\begin{tabular}{C{60mm}}
\xskakset{moveid=\xskakgetgame{lastmoveid}}
\chessboard[setfen=\xskakget{nextfen},
       pgfstyle=border,
       color=YellowGreen,
       markfields={e8,d7},
             pgfstyle=straightmove,
             color=YellowGreen,
             markmoves={e8-d7}]
\newline
43. ...\,\xskakget{lan}
\newline
0-1
\end{tabular}
\end{center}
\end{flushleft}
\end{multicols*}
\newpage
\end{document}
