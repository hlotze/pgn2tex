\documentclass[../main.tex]{subfiles}

\begin{document}

\index{Players ! Capablanca, Jose Raul $\square$}
\index{Players ! Marshall, Frank James $\blacksquare$}
\subsection{Capablanca, Jose Raul vs. Marshall, Frank James -- 1-0 -- E15}
\begin{multicols*}{2}

% Game's Opening ECO data
\index{Openings ! E15 -- Queen's Indian: Rubinstein Variation}
\subsubsection{E15 -- Queen's Indian: Rubinstein Variation}
\begin{flushleft}
\newchessgame[id=eco]
\longmoves
\mainline{1. d4 Nf6 2. c4 e6 3. Nf3 b6 4. g3 Bb7 5. Bg2 c5 6. d5 exd5 7. Nh4}
\begin{center}
\begin{tabular}{C{60mm}}
\chessboard[setfen={rn1qkb1r/pb1p1ppp/1p3n2/2pp4/2P4N/6P1/PP2PPBP/RNBQK2R b KQkq - 1 7},
             pgfstyle=border,
             color=YellowGreen,
             markfields={f3,h4},
             pgfstyle=straightmove,
             color=YellowGreen,
             markmoves={f3-h4}]
\newline
\xskakset{moveid=\xskakgetgame{lastmoveid}}
\printmovercolor{\xskakgetgame{lastplayer}}
\end{tabular}
\end{center}
% PGN tags
\begin{tabular}{L{60mm} R{10mm}}
\multicolumn{2}{l}{\textbf{Karlsbad, Karlsbad}}\\ 
\multicolumn{2}{l}{1929}\\[3mm]
\textbf{$\square$ \hspace{2mm} Capablanca, Jose Raul} & \textbf{1}\\ 
\textbf{$\blacksquare$ \hspace{2mm} Marshall, Frank James} & \textbf{0}\\ 
\end{tabular}

% Game's final diagram and result
\newchessgame[id=overview]
\longmoves
\hidemoves{1. d4 Nf6 2. c4 e6 3. Nf3 b6 4. g3 Bb7 5. Bg2 c5 6. d5 exd5 7. Nh4}\mainline{7...  g6 8. Nc3 Bg7 9. O-O O-O 10. Bg5 h6 11. Nxd5 Bxd5 12. Bxf6 Qxf6 13. Qxd5 Nc6 14. Qxd7 Ne5 15. Qa4 Rae8 16. Bd5 g5 17. Ng2 Ng6 18. e3 Re7 19. Qc2 Rd7 20. b3 Ne7 21. Rad1 Rfd8 22. e4 Qg6 23. f4 Qh5 24. fxg5 Nxd5 25. exd5 hxg5 26. Qf5 Bd4+ 27. Kh1 Re7 28. Rde1 Rxe1 29. Nxe1 Rd6 30. g4 Qg6 31. Nf3 Qxf5 32. gxf5 Be3 33. Kg2 b5 34. Re1 Bf4 35. Kh3 bxc4 36. bxc4 Ra6 37. Re2 Ra3 38. Kg4 Rc3 39. Nxg5 Rxc4 40. Re8+ Kg7 41. Ne4 Bxh2 42. Kh5 Bf4 43. f6+ Kh7 44. Re7 Kg8 45. d6 Rd4 46. d7 Rd5+ 47. Kg4 Bc7 48. Ng5 Rd4+ 49. Kh5 }

\begin{center}
\begin{tabular}{C{60mm}}
\xskakset{moveid=\xskakgetgame{lastmoveid}}
\chessboard[setfen=\xskakget{nextfen},
       pgfstyle=border,
       color=YellowGreen,
       markfields={g4,h5},
             pgfstyle=straightmove,
             color=YellowGreen,
             markmoves={g4-h5}]
\newline
49.\,\xskakget{lan} ...
\newline
1-0
\end{tabular}
\end{center}
\end{flushleft}
\end{multicols*}
\newpage
\end{document}
