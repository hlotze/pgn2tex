\documentclass[../main.tex]{subfiles}

\begin{document}

\index{Players ! Capablanca, Jose Raul $\square$}
\index{Players ! Ragozin, Viacheslav $\blacksquare$}
\subsection{Capablanca, Jose Raul vs. Ragozin, Viacheslav -- 1-0 -- E22}
\begin{multicols*}{2}

% Game's Opening ECO data
\index{Openings ! E22 -- Nimzo-Indian: Spielmann, 4...Nc6}
\subsubsection{E22 -- Nimzo-Indian: Spielmann, 4...Nc6}
\begin{flushleft}
\newchessgame[id=eco]
\longmoves
\mainline{1. d4 Nf6 2. c4 e6 3. Nc3 Bb4 4. Qb3 Nc6}
\begin{center}
\begin{tabular}{C{60mm}}
\chessboard[setfen={r1bqk2r/pppp1ppp/2n1pn2/8/1bPP4/1QN5/PP2PPPP/R1B1KBNR w KQkq - 4 5},
             pgfstyle=border,
             color=YellowGreen,
             markfields={b8,c6},
             pgfstyle=straightmove,
             color=YellowGreen,
             markmoves={b8-c6}]
\newline
\xskakset{moveid=\xskakgetgame{lastmoveid}}
\printmovercolor{\xskakgetgame{lastplayer}}
\end{tabular}
\end{center}
% PGN tags
\begin{tabular}{L{60mm} R{10mm}}
\multicolumn{2}{l}{\textbf{Moscow, Moscow}}\\ 
\multicolumn{2}{l}{1936}\\[3mm]
\textbf{$\square$ \hspace{2mm} Capablanca, Jose Raul} & \textbf{1}\\ 
\textbf{$\blacksquare$ \hspace{2mm} Ragozin, Viacheslav} & \textbf{0}\\ 
\end{tabular}

% Game's final diagram and result
\newchessgame[id=overview]
\longmoves
\hidemoves{1. d4 Nf6 2. c4 e6 3. Nc3 Bb4 4. Qb3 Nc6}\mainline{5. e3 d5 6. Nf3 O-O 7. a3 dxc4 8. Bxc4 Bd6 9. Bb5 e5 10. Bxc6 exd4 11. Nxd4 bxc6 12. Nxc6 Qd7 13. Nd4 Qg4 14. O-O Ba6 15. h3 Qh4 16. Nf3 Qh5 17. Re1 Rab8 18. Qa4 Bb7 19. e4 h6 20. Be3 Rfe8 21. Bd4 Nh7 22. Bxa7 Ra8 23. Qb5 Qxb5 24. Nxb5 Rxe4 25. Rxe4 Bxe4 26. Nd2 Bd3 27. Nxd6 Rxa7 28. N6e4 Nf8 29. Nc5 Bf5 30. Nf3 Ne6 31. Rc1 Kf8 32. Nxe6+ Bxe6 33. Nd4 Rb7 34. b4 Bd7 35. f4 Ke7 36. Kf2 Ra7 37. Rc3 Kd6 38. Rd3 Ke7 39. Ke3 Ra4 40. Rc3 Kd6 41. Rd3 Ke7 42. Rc3 Kd6 43. Ne2 g6 44. Rd3+ Ke6 45. Kd4 Ra6 46. Re3+ Kd6 47. Nc3 f5 48. b5 Ra8 49. Kc4 Be6+ 50. Kb4 c5+ 51. bxc6 Bg8 52. Nb5+ Kxc6 53. Rd3 g5 54. Rd6+ Kb7 55. fxg5 hxg5 56. Rg6 Rf8 57. Rxg5 f4 58. Nd4 Rc8 59. Rg7+ Kb6 60. Rg6+ Kb7 61. Nb5 Rf8 62. Nd6+ Kb8 63. h4 }

\begin{center}
\begin{tabular}{C{60mm}}
\xskakset{moveid=\xskakgetgame{lastmoveid}}
\chessboard[setfen=\xskakget{nextfen},
       pgfstyle=border,
       color=YellowGreen,
       markfields={h3,h4},
             pgfstyle=straightmove,
             color=YellowGreen,
             markmoves={h3-h4}]
\newline
63.\,\xskakget{lan} ...
\newline
1-0
\end{tabular}
\end{center}
\end{flushleft}
\end{multicols*}
\newpage
\end{document}
