\documentclass[../main.tex]{subfiles}

\begin{document}

\index{Players ! Capablanca, Jose Raul $\square$}
\index{Players ! Marshall, Frank James $\blacksquare$}
\subsection{Capablanca, Jose Raul vs. Marshall, Frank James -- 1-0 -- C42}
\begin{multicols*}{2}

% Game's Opening ECO data
\index{Openings ! C42 -- Russian Game: Cozio/Lasker}
\subsubsection{C42 -- Russian Game: Cozio/Lasker}
\begin{flushleft}
\newchessgame[id=eco]
\longmoves
\mainline{1. e4 e5 2. Nf3 Nf6 3. Nxe5 d6 4. Nf3 Nxe4 5. Qe2}
\begin{center}
\begin{tabular}{C{60mm}}
\chessboard[setfen={rnbqkb1r/ppp2ppp/3p4/8/4n3/5N2/PPPPQPPP/RNB1KB1R b KQkq - 1 5},
             pgfstyle=border,
             color=YellowGreen,
             markfields={d1,e2},
             pgfstyle=straightmove,
             color=YellowGreen,
             markmoves={d1-e2}]
\newline
\xskakset{moveid=\xskakgetgame{lastmoveid}}
\printmovercolor{\xskakgetgame{lastplayer}}
\end{tabular}
\end{center}
% PGN tags
\begin{tabular}{L{60mm} R{10mm}}
\multicolumn{2}{l}{\textbf{St Petersburg, St Petersburg f}}\\ 
\multicolumn{2}{l}{1914}\\[3mm]
\textbf{$\square$ \hspace{2mm} Capablanca, Jose Raul} & \textbf{1}\\ 
\textbf{$\blacksquare$ \hspace{2mm} Marshall, Frank James} & \textbf{0}\\ 
\end{tabular}

% Game's final diagram and result
\newchessgame[id=overview]
\longmoves
\hidemoves{1. e4 e5 2. Nf3 Nf6 3. Nxe5 d6 4. Nf3 Nxe4 5. Qe2}\mainline{5...  Qe7 6. d3 Nf6 7. Bg5 Be6 8. Nc3 h6 9. Bxf6 Qxf6 10. d4 Be7 11. Qb5+ Nd7 12. Bd3 g5 13. h3 O-O 14. Qxb7 Rab8 15. Qe4 Qg7 16. b3 c5 17. O-O cxd4 18. Nd5 Bd8 19. Bc4 Nc5 20. Qxd4 Qxd4 21. Nxd4 Bxd5 22. Bxd5 Bf6 23. Rad1 Bxd4 24. Rxd4 Kg7 25. Bc4 Rb6 26. Re1 Kf6 27. f4 Ne6 28. fxg5+ hxg5 29. Rf1+ Ke7 30. Rg4 Rg8 31. Rf5 Rc6 32. h4 Rgc8 33. hxg5 Rc5 34. Bxe6 fxe6 35. Rxc5 Rxc5 36. g6 Kf8 37. Rc4 Ra5 38. a4 Kg7 39. Rc6 Rd5 40. Rc7+ Kxg6 41. Rxa7 Rd1+ 42. Kh2 d5 43. a5 Rc1 44. Rc7 Ra1 45. b4 Ra4 46. c3 d4 47. Rc6 dxc3 48. Rxc3 Rxb4 49. Ra3 Rb7 50. a6 Ra7 51. Ra5 Kf6 52. g4 Ke7 53. Kg3 Kd6 54. Kf4 Kc7 55. Ke5 Kd7 56. g5 Ke7 57. g6 Kf8 58. Kxe6 Ke8 59. g7 Rxg7 60. a7 Rg6+ 61. Kf5 }

\begin{center}
\begin{tabular}{C{60mm}}
\xskakset{moveid=\xskakgetgame{lastmoveid}}
\chessboard[setfen=\xskakget{nextfen},
       pgfstyle=border,
       color=YellowGreen,
       markfields={e6,f5},
             pgfstyle=straightmove,
             color=YellowGreen,
             markmoves={e6-f5}]
\newline
61.\,\xskakget{lan} ...
\newline
1-0
\end{tabular}
\end{center}
\end{flushleft}
\end{multicols*}
\newpage
\end{document}
