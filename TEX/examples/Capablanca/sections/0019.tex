\documentclass[../main.tex]{subfiles}

\begin{document}

\index{Players ! Marshall, Frank James $\square$}
\index{Players ! Capablanca, Jose Raul $\blacksquare$}
\subsection{Marshall, Frank James vs. Capablanca, Jose Raul -- 0-1 -- D53}
\begin{multicols*}{2}

% Game's Opening ECO data
\index{Openings ! D53 -- QGD: Early Lasker Variation}
\subsubsection{D53 -- QGD: Early Lasker Variation}
\begin{flushleft}
\newchessgame[id=eco]
\longmoves
\mainline{1. d4 d5 2. c4 e6 3. Nc3 Nf6 4. Bg5 Be7 5. e3 Ne4}
\begin{center}
\begin{tabular}{C{60mm}}
\chessboard[setfen={rnbqk2r/ppp1bppp/4p3/3p2B1/2PPn3/2N1P3/PP3PPP/R2QKBNR w KQkq - 1 6},
             pgfstyle=border,
             color=YellowGreen,
             markfields={f6,e4},
             pgfstyle=straightmove,
             color=YellowGreen,
             markmoves={f6-e4}]
\newline
\xskakset{moveid=\xskakgetgame{lastmoveid}}
\printmovercolor{\xskakgetgame{lastplayer}}
\end{tabular}
\end{center}
% PGN tags
\begin{tabular}{L{60mm} R{10mm}}
\multicolumn{2}{l}{\textbf{New York, USA m}}\\ 
\multicolumn{2}{l}{1909 Round 5}\\[3mm]
\textbf{$\square$ \hspace{2mm} Marshall, Frank James} & \textbf{0}\\ 
\textbf{$\blacksquare$ \hspace{2mm} Capablanca, Jose Raul} & \textbf{1}\\ 
\end{tabular}

% Game's final diagram and result
\newchessgame[id=overview]
\longmoves
\hidemoves{1. d4 d5 2. c4 e6 3. Nc3 Nf6 4. Bg5 Be7 5. e3 Ne4}\mainline{6. Bxe7 Qxe7 7. Bd3 Nxc3 8. bxc3 Nd7 9. Nf3 O-O 10. Qc2 h6 11. O-O c5 12. Rfe1 dxc4 13. Bxc4 b6 14. Qe4 Rb8 15. Bd3 Nf6 16. Qf4 Bb7 17. e4 Rfd8 18. Rad1 Rbc8 19. Re3 cxd4 20. cxd4 Rc3 21. Bb1 g5 22. Nxg5 Rxe3 23. Qxe3 Ng4 24. Qg3 Qxg5 25. h4 Qg7 26. Qc7 Rxd4 27. Qb8+ Kh7 28. e5+ Be4 29. Rxd4 Bxb1 30. Qxa7 Nxe5 31. Rf4 Be4 32. g3 Nf3+ 33. Kg2 f5 34. Qxb6 Nxh4+ 35. Kh2 Nf3+ 36. Rxf3 Bxf3 37. Qxe6 Be4 38. f3 Bd3 39. Qd5 Qb2+ 40. Kg1 Bb1 41. a4 Qa1 42. Qb7+ Kg6 43. Qb6+ Kh5 44. Kh2 Ba2 45. Qb5 Kg6 46. a5 Qd4 47. Qc6+ Qf6 48. Qe8+ Qf7 49. Qa4 Qe6 50. a6 Qe2+ 51. Kh3 Bd5 52. a7 Bxf3}

\begin{center}
\begin{tabular}{C{60mm}}
\xskakset{moveid=\xskakgetgame{lastmoveid}}
\chessboard[setfen=\xskakget{nextfen},
       pgfstyle=border,
       color=YellowGreen,
       markfields={d5,f3},
             pgfstyle=straightmove,
             color=YellowGreen,
             markmoves={d5-f3}]
\newline
52. ...\,\xskakget{lan}
\newline
0-1
\end{tabular}
\end{center}
\end{flushleft}
\end{multicols*}
\newpage
\end{document}
