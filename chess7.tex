\documentclass[10pt]{article}
\usepackage[a4paper, total={160mm, 250mm}]{geometry}
\usepackage{longtable}
\usepackage{array}
\usepackage[dvipsnames]{xcolor}
\usepackage{xskak} %or skak
\usepackage{chessboard}
\usepackage{fancyhdr}
\usepackage[lastpage,user]{zref}

\pagestyle{fancy}
\fancyhf{}
\rhead{Sorensen,H vs. Carlsen,Magnus -- 1-0 -- D48}
\lhead{2001.01.11: Troll Masters -- Gausdal NOR}
%\rfoot{Page \thepage}
\cfoot{\thepage\ of \zpageref{LastPage}}

\setchessboard{
tinyboard,
showmover=false}



\begin{document}

\section*{2001.01.11: Troll Masters -- Gausdal NOR}

\subsection*{Sorensen,H vs. Carlsen,Magnus -- 1-0 -- D48}

\subsubsection*{Game's PGN}

\begin{flushleft}
[Event] "Troll Masters"

[Site] "Gausdal NOR"

[Date] "2001.01.11"

[Round] "8"

[White] "Sorensen,H"

[Black] "Carlsen,Magnus"

[Result] "1-0"

[BlackElo] ""

[ECO] "D48"

[WhiteElo] "2245"
\end{flushleft}
\parindent 0mm
 
\begin{flushleft}
1. d4 d5 2. c4 c6 3. Nc3 Nf6 4. Nf3 e6 5. e3 Nbd7 6. Bd3 dxc4 7. Bxc4 b5 8. Bd3 a6 9. a4 Bb7 10. O-O b4 11. Ne4 Nxe4 12. Bxe4 Nf6 13. Nd2 Nxe4 14. Nxe4 Qd5 15. f3 f5 16. Nf2 Rd8 17. b3 c5 18. Bb2 cxd4 19. Bxd4 e5 20. Bb6 Rd6 21. a5 Qe6 22. Qc2 Be7 23. Qc4 Qxc4 24. bxc4 Kf7 25. Rfc1 Rc8 26. Rab1 Ke6 27. c5 Rd2 28. Rxb4 Bc6 29. Rb3 Bb5 30. Rbc3 Rc6 31. e4 f4 32. Rd1 Rxd1+ 33. Nxd1 Ba4 34. Nb2 Bb5 35. Kf2 Bf8 36. g3 Be7 37. Rc2 g6 38. Ke1 Kd7 39. Kd2 Ke6 40. Nd3 Bg5 41. g4 Be7 42. Nb4 Rc8 43. Nd5 Kd7 44. Kc1 Ba4 45. Rc4 Bb5 46. Rc2 Ba4 47. Rc3 Bb5 48. Kd2 Bh4 49. Rc1 Bf2 50. c6+ 1-0
\end{flushleft}


\subsubsection*{Game's diagrams}

\newchessgame
\hidemoves{1. d4 d5 2. c4 c6 3. Nc3 Nf6 4. Nf3 e6 5. e3 Nbd7 6. Bd3 dxc4 7. Bxc4 b5 8. Bd3 a6 9. a4 Bb7 10. O-O b4 11. Ne4 Nxe4 12. Bxe4 Nf6 13. Nd2 Nxe4 14. Nxe4 Qd5 15. f3 f5 16. Nf2 Rd8 17. b3 c5 18. Bb2 cxd4 19. Bxd4 e5 20. Bb6 Rd6 21. a5 Qe6 22. Qc2 Be7 23. Qc4 Qxc4 24. bxc4 Kf7 25. Rfc1 Rc8 26. Rab1 Ke6 27. c5 Rd2 28. Rxb4 Bc6 29. Rb3 Bb5 30. Rbc3 Rc6 31. e4 f4 32. Rd1 Rxd1+ 33. Nxd1 Ba4 34. Nb2 Bb5 35. Kf2 Bf8 36. g3 Be7 37. Rc2 g6 38. Ke1 Kd7 39. Kd2 Ke6 40. Nd3 Bg5 41. g4 Be7 42. Nb4 Rc8 43. Nd5 Kd7 44. Kc1 Ba4 45. Rc4 Bb5 46. Rc2 Ba4 47. Rc3 Bb5 48. Kd2 Bh4 49. Rc1 Bf2 50. c6+}


\begin{center}

\begin{longtable}{ c c c c }
\setcounter{LTchunksize}{1000}


Sorensen,H & Carlsen,Magnus & Sorensen,H & Carlsen,Magnus
\hline
\endhead

%------------------------------------- 1 ---------
\xskakset{moveid=1w}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={e2,e4},
            pgfstyle=straightmove, markmoves={e2-e4}]
%\\1.\,\xskakget{lan}\\
&
\xskakset{moveid=1b}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={e7,e5},
            pgfstyle=straightmove, markmoves={e7-e5}]
%\\1. ...\,\xskakget{lan}\\
&
\xskakset{moveid=2w}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={g1,f3},
            pgfstyle=straightmove, markmoves={g1-f3}]
%\\2.\,\xskakget{lan}\\
&
\xskakset{moveid=2b}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={b8,c6},
            pgfstyle=straightmove, markmoves={b8-c6}]
%\\2. ...\,\xskakget{lan}\\
\\
\nopagebreak[4]
\xskakset{moveid=1w}
1.\,\xskakget{lan}
& 
\xskakset{moveid=1b}
1. ...\,\xskakget{lan} 
&
\xskakset{moveid=2w}
2.\,\xskakget{lan}
& 
\xskakset{moveid=2b}
2. ...\,\xskakget{lan} 
\\[2mm]

%------------------------------------- 2 ---------
\xskakset{moveid=3w}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={e2,e4},
            pgfstyle=straightmove, markmoves={e2-e4}]
%\\1.\,\xskakget{lan}\\
&
\xskakset{moveid=3b}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={e7,e5},
            pgfstyle=straightmove, markmoves={e7-e5}]
%\\1. ...\,\xskakget{lan}\\
&
\xskakset{moveid=4w}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={g1,f3},
            pgfstyle=straightmove, markmoves={g1-f3}]
%\\2.\,\xskakget{lan}\\
&
\xskakset{moveid=4b}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={b8,c6},
            pgfstyle=straightmove, markmoves={b8-c6}]
%\\2. ...\,\xskakget{lan}\\
\\
\nopagebreak[4]
\xskakset{moveid=3w}
1.\,\xskakget{lan}
& 
\xskakset{moveid=3b}
1. ...\,\xskakget{lan} 
&
\xskakset{moveid=4w}
2.\,\xskakget{lan}
& 
\xskakset{moveid=4b}
2. ...\,\xskakget{lan} 
\\[2mm]

%------------------------------------- 3 ---------
\xskakset{moveid=5w}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={e2,e4},
            pgfstyle=straightmove, markmoves={e2-e4}]
%\\1.\,\xskakget{lan}\\
&
\xskakset{moveid=5b}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={e7,e5},
            pgfstyle=straightmove, markmoves={e7-e5}]
%\\1. ...\,\xskakget{lan}\\
&
\xskakset{moveid=6w}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={g1,f3},
            pgfstyle=straightmove, markmoves={g1-f3}]
%\\2.\,\xskakget{lan}\\
&
\xskakset{moveid=6b}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={b8,c6},
            pgfstyle=straightmove, markmoves={b8-c6}]
%\\2. ...\,\xskakget{lan}\\
\\
\nopagebreak[4]
\xskakset{moveid=5w}
1.\,\xskakget{lan}
& 
\xskakset{moveid=5b}
1. ...\,\xskakget{lan} 
&
\xskakset{moveid=6w}
2.\,\xskakget{lan}
& 
\xskakset{moveid=6b}
2. ...\,\xskakget{lan} 
\\[2mm]

%------------------------------------- 4 ---------
\xskakset{moveid=7w}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={e2,e4},
            pgfstyle=straightmove, markmoves={e2-e4}]
%\\1.\,\xskakget{lan}\\
&
\xskakset{moveid=7b}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={e7,e5},
            pgfstyle=straightmove, markmoves={e7-e5}]
%\\1. ...\,\xskakget{lan}\\
&
\xskakset{moveid=8w}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={g1,f3},
            pgfstyle=straightmove, markmoves={g1-f3}]
%\\2.\,\xskakget{lan}\\
&
\xskakset{moveid=8b}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={b8,c6},
            pgfstyle=straightmove, markmoves={b8-c6}]
%\\2. ...\,\xskakget{lan}\\
\\
\nopagebreak[4]
\xskakset{moveid=7w}
1.\,\xskakget{lan}
& 
\xskakset{moveid=7b}
1. ...\,\xskakget{lan} 
&
\xskakset{moveid=8w}
2.\,\xskakget{lan}
& 
\xskakset{moveid=8b}
2. ...\,\xskakget{lan} 
\\[2mm]

%------------------------------------- 5 ---------
\xskakset{moveid=9w}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={e2,e4},
            pgfstyle=straightmove, markmoves={e2-e4}]
%\\1.\,\xskakget{lan}\\
&
\xskakset{moveid=9b}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={e7,e5},
            pgfstyle=straightmove, markmoves={e7-e5}]
%\\1. ...\,\xskakget{lan}\\
&
\xskakset{moveid=10w}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={g1,f3},
            pgfstyle=straightmove, markmoves={g1-f3}]
%\\2.\,\xskakget{lan}\\
&
\xskakset{moveid=10b}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={b8,c6},
            pgfstyle=straightmove, markmoves={b8-c6}]
%\\2. ...\,\xskakget{lan}\\
\\
\nopagebreak[4]
\xskakset{moveid=9w}
1.\,\xskakget{lan}
& 
\xskakset{moveid=9b}
1. ...\,\xskakget{lan} 
&
\xskakset{moveid=10w}
2.\,\xskakget{lan}
& 
\xskakset{moveid=10w}
2. ...\,\xskakget{lan} 
\\[2mm]

%------------------------------------- 6 ---------
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={e2,e4},
            pgfstyle=straightmove, markmoves={e2-e4}]
%\\1.\,\xskakget{lan}\\
&
\xskakset{moveid=1b}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={e7,e5},
            pgfstyle=straightmove, markmoves={e7-e5}]
%\\1. ...\,\xskakget{lan}\\
&
\xskakset{moveid=2w}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={g1,f3},
            pgfstyle=straightmove, markmoves={g1-f3}]
%\\2.\,\xskakget{lan}\\
&
\xskakset{moveid=2b}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={b8,c6},
            pgfstyle=straightmove, markmoves={b8-c6}]
%\\2. ...\,\xskakget{lan}\\
\\
\nopagebreak[4]
\xskakset{moveid=1w}
1.\,\xskakget{lan}
& 
\xskakset{moveid=1b}
1. ...\,\xskakget{lan} 
&
\xskakset{moveid=2w}
2.\,\xskakget{lan}
& 
\xskakset{moveid=2w}
2. ...\,\xskakget{lan} 
\\[2mm]

%------------------------------------- 7 ---------
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={e2,e4},
            pgfstyle=straightmove, markmoves={e2-e4}]
%\\1.\,\xskakget{lan}\\
&
\xskakset{moveid=1b}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={e7,e5},
            pgfstyle=straightmove, markmoves={e7-e5}]
%\\1. ...\,\xskakget{lan}\\
&
\xskakset{moveid=2w}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={g1,f3},
            pgfstyle=straightmove, markmoves={g1-f3}]
%\\2.\,\xskakget{lan}\\
&
\xskakset{moveid=2b}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={b8,c6},
            pgfstyle=straightmove, markmoves={b8-c6}]
%\\2. ...\,\xskakget{lan}\\
\\
\nopagebreak[4]
\xskakset{moveid=1w}
1.\,\xskakget{lan}
& 
\xskakset{moveid=1b}
1. ...\,\xskakget{lan} 
&
\xskakset{moveid=2w}
2.\,\xskakget{lan}
& 
\xskakset{moveid=2w}
2. ...\,\xskakget{lan} 
\\[2mm]

%------------------------------------- 8 ---------
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={e2,e4},
            pgfstyle=straightmove, markmoves={e2-e4}]
%\\1.\,\xskakget{lan}\\
&
\xskakset{moveid=1b}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={e7,e5},
            pgfstyle=straightmove, markmoves={e7-e5}]
%\\1. ...\,\xskakget{lan}\\
&
\xskakset{moveid=2w}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={g1,f3},
            pgfstyle=straightmove, markmoves={g1-f3}]
%\\2.\,\xskakget{lan}\\
&
\xskakset{moveid=2b}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={b8,c6},
            pgfstyle=straightmove, markmoves={b8-c6}]
%\\2. ...\,\xskakget{lan}\\
\\
\nopagebreak[4]
\xskakset{moveid=1w}
1.\,\xskakget{lan}
& 
\xskakset{moveid=1b}
1. ...\,\xskakget{lan} 
&
\xskakset{moveid=2w}
2.\,\xskakget{lan}
& 
\xskakset{moveid=2w}
2. ...\,\xskakget{lan} 
\\
%------------------------------------- 7 ---------
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={e2,e4},
            pgfstyle=straightmove, markmoves={e2-e4}]
%\\1.\,\xskakget{lan}\\
&
\xskakset{moveid=1b}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={e7,e5},
            pgfstyle=straightmove, markmoves={e7-e5}]
%\\1. ...\,\xskakget{lan}\\
&
\xskakset{moveid=2w}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={g1,f3},
            pgfstyle=straightmove, markmoves={g1-f3}]
%\\2.\,\xskakget{lan}\\
&
\xskakset{moveid=2b}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={b8,c6},
            pgfstyle=straightmove, markmoves={b8-c6}]
%\\2. ...\,\xskakget{lan}\\
\\
\nopagebreak[4]
\xskakset{moveid=1w}
1.\,\xskakget{lan}
& 
\xskakset{moveid=1b}
1. ...\,\xskakget{lan} 
&
\xskakset{moveid=2w}
2.\,\xskakget{lan}
& 
\xskakset{moveid=2w}
2. ...\,\xskakget{lan} 
\\[2mm]

%------------------------------------- 8 ---------
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={e2,e4},
            pgfstyle=straightmove, markmoves={e2-e4}]
%\\1.\,\xskakget{lan}\\
&
\xskakset{moveid=1b}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={e7,e5},
            pgfstyle=straightmove, markmoves={e7-e5}]
%\\1. ...\,\xskakget{lan}\\
&
\xskakset{moveid=2w}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={g1,f3},
            pgfstyle=straightmove, markmoves={g1-f3}]
%\\2.\,\xskakget{lan}\\
&
\xskakset{moveid=2b}
\chessboard[setfen=\xskakget{nextfen},
            pgfstyle=border, color=LimeGreen, markfields={b8,c6},
            pgfstyle=straightmove, markmoves={b8-c6}]
%\\2. ...\,\xskakget{lan}\\
\\
\nopagebreak[4]
\xskakset{moveid=1w}
1.\,\xskakget{lan}
& 
\xskakset{moveid=1b}
1. ...\,\xskakget{lan} 
&
\xskakset{moveid=2w}
2.\,\xskakget{lan}
& 
\xskakset{moveid=2w}
2. ...\,\xskakget{lan} 
\\

\end{longtable}
\end{center}

\end{document}